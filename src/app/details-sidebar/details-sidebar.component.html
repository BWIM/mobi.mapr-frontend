<div class="h-full">
    <p-scrollPanel [style]="{width: '100%', height: '100%'}">
      <div *ngIf="projectInfo" class="p-4">
        <div class="mb-4">
        </div>

        <div class="mb-6">
          <h3 class="text-xl font-semibold text-primary mb-2">
            {{ projectInfo.display_name }}
          </h3> 
          <p class="text-gray-600">{{ projectInfo.description }}</p>
        </div>

        <div *ngIf="projectInfo.type !== 'hexagons'">
          <!-- <div class="mb-4">
            <label class="block text-sm font-medium text-gray-700 mb-2">{{ 'SIDEBAR.AVERAGE_TYPE' | translate }}</label>
            <p-selectButton [options]="[
              { label: ('SIDEBAR.MEDIAN' | translate), value: 'median' },
              { label: ('SIDEBAR.AVERAGE' | translate), value: 'mean' }
            ]" [(ngModel)]="selectedAverageType" optionLabel="label" optionValue="value" (onChange)="onVisualizationChange()" [allowEmpty]="false">
            </p-selectButton>
          </div> -->

          <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">{{ 'SIDEBAR.POPULATION_AREA' | translate }}</label>
            <p-selectButton [options]="[
              { label: ('SIDEBAR.POPULATION' | translate), value: 'pop' },
              { label: ('SIDEBAR.AREA' | translate), value: 'area' }
            ]" [(ngModel)]="selectedPopulationArea" optionLabel="label" optionValue="value" (onChange)="onVisualizationChange()" [allowEmpty]="false">
            </p-selectButton>
          </div>
        </div>

        <!-- <div class="mt-6 flex">
          <p-button 
            (mousedown)="setLowOpacity()"
            (mouseup)="resetOpacity()"
            (mouseleave)="resetOpacity()"
            icon="pi pi-eye-slash"
            [label]="'SIDEBAR.REDUCE_OPACITY' | translate"
            [pTooltip]="'SIDEBAR.REDUCE_OPACITY_TOOLTIP' | translate"
            [styleClass]="'p-button-secondary mb-4'">
          </p-button>
        </div> -->


        <!-- <div class="mb-6">
          <p-fieldset legend="{{ 'SIDEBAR.OPACITY_THRESHOLDS' | translate }}">
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  {{ 'SIDEBAR.COUNTY_THRESHOLD' | translate }}
                </label>
                <p-slider 
                  [(ngModel)]="opacityThresholds.county"
                  [min]="50"
                  [max]="1000"
                  [step]="50"
                  (ngModelChange)="onOpacityThresholdChange('county', $event)">
                </p-slider>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  {{ 'SIDEBAR.MUNICIPALITY_THRESHOLD' | translate }}
                </label>
                <p-slider 
                  [(ngModel)]="opacityThresholds.municipality"
                  [min]="100"
                  [max]="2000"
                  [step]="100"
                  (ngModelChange)="onOpacityThresholdChange('municipality', $event)">
                </p-slider>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  {{ 'SIDEBAR.HEXAGON_THRESHOLD' | translate }}
                </label>
                <p-slider 
                  [(ngModel)]="opacityThresholds.hexagon"
                  [min]="200"
                  [max]="5000"
                  [step]="200"
                  (ngModelChange)="onOpacityThresholdChange('hexagon', $event)">
                </p-slider>
              </div>
            </div>
          </p-fieldset>
        </div> -->

        <!-- Separator -->
        <div class="my-6 border-t border-gray-200"></div>

        <p-fieldset legend="Activities">
          <ul class="list-disc pl-4 space-y-1">
            <li *ngFor="let activity of projectInfo.activities" class="text-gray-700">
              {{ activity }}
            </li>
          </ul>
        </p-fieldset>

        <p-fieldset legend="Modes">
          <ul class="list-disc pl-4 space-y-1">
            <li *ngFor="let mode of projectInfo.modes" class="text-gray-700">
              {{ mode }}
            </li>
          </ul>
        </p-fieldset>

        <p-fieldset legend="Personas">
          <ul class="list-disc pl-4 space-y-1">
            <li *ngFor="let persona of projectInfo.personas" class="text-gray-700">
              {{ persona }}
            </li>
          </ul>
        </p-fieldset>

        <div class="mt-6 flex justify-center">
          <p-button 
            (onClick)="exportToPDFLandscape()"
            icon="pi pi-file-pdf"
            [label]="'SIDEBAR.EXPORT_PDF_LANDSCAPE' | translate"
            [pTooltip]="'SIDEBAR.EXPORT_PDF_LANDSCAPE_TOOLTIP' | translate"
            styleClass="p-button-primary"
            [disabled]="isExporting">
          </p-button>
        </div>

        <div class="mt-6 flex justify-center">
          <p-button 
            (onClick)="exportToPDFPortrait()"
            icon="pi pi-file-pdf"
            [label]="'SIDEBAR.EXPORT_PDF_PORTRAIT' | translate"
            [pTooltip]="'SIDEBAR.EXPORT_PDF_PORTRAIT_TOOLTIP' | translate"
            styleClass="p-button-primary"
            [disabled]="isExporting">
          </p-button>
        </div>

        <div class="mt-6 flex justify-center">
          <p-button 
            (onClick)="toggleStatistics()"
            icon="pi pi-chart-bar"
            [label]="'STATISTICS.TITLE' | translate"
            [pTooltip]="'STATISTICS.SHOW_STATISTICS_TOOLTIP' | translate"
            styleClass="p-button-secondary">
          </p-button>
        </div>

        <div class="mt-6 flex justify-center">
          <p-button 
            (onClick)="generateShareLink()"
            icon="pi pi-share-alt"
            [label]="'SIDEBAR.SHARE' | translate"
            [pTooltip]="'SIDEBAR.SHARE_TOOLTIP' | translate"
            styleClass="p-button-secondary"
            [disabled]="isGeneratingShare">
            <p-progressSpinner *ngIf="isGeneratingShare" 
              [style]="{width: '20px', height: '20px'}" 
              styleClass="ml-2"></p-progressSpinner>
          </p-button>
        </div>

        <div *ngIf="shareUrl" class="mt-4 p-4 bg-gray-100 rounded">
          <div class="flex justify-between items-center mb-2">
            <p class="text-sm text-gray-600">{{ 'SIDEBAR.SHARE_LINK' | translate }}:</p>
            <button class="text-blue-600 hover:text-blue-800 text-sm"
                    (click)="copyToClipboard(shareUrl)">
              <i class="pi pi-copy mr-1"></i>
              {{ 'SIDEBAR.COPY_LINK' | translate }}
            </button>
          </div>
          <div class="break-all">
            <a [href]="shareUrl" target="_blank" class="text-blue-600 hover:text-blue-800">
              {{shareUrl}}
            </a>
          </div>
        </div>
      </div>
      
      <div *ngIf="!projectInfo" class="p-4 text-center text-gray-500">
        {{ 'SIDEBAR.NO_PROJECT_SELECTED' | translate }}
      </div>
    </p-scrollPanel>
</div>

<p-dialog 
    [visible]="isExporting" 
    [modal]="true" 
    [closable]="false" 
    [draggable]="false"
    [resizable]="false"
    [closeOnEscape]="false"
    [style]="{width: '300px'}"
    [appendTo]="'body'"
    [showHeader]="false">
    <div class="flex flex-column align-items-center">
        <h3>{{ 'EXPORT.GENERATING_PDF' | translate }}</h3>
    </div>
</p-dialog>